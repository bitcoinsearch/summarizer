<?xml version="1.0" ?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - Detailed protocol design for routed multi-transaction CoinSwap</title>
  <updated>2025-09-26T15:32:35.633008+00:00</updated>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <thread>
    <message id="msg_1" depth="0" position="0" anchor="me25a5125e7b4da1b5f807e8affb712e2be9a592c">
      <author>[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap Chris Belcher</author>
      <timestamp>2020-08-11T12:05:00.000Z</timestamp>
    </message>
    <message id="msg_2" depth="1" position="1" reply_to="[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap Chris Belcher" parent_id="mailing-list-2020-08-me25a5125e7b4da1b5f807e8affb712e2be9a592c" anchor="m9a793122ab782594fe1af16be43036377eebfad8">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-20T11:17:00.000Z</timestamp>
    </message>
    <message id="msg_3" depth="2" position="2" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-08-m9a793122ab782594fe1af16be43036377eebfad8" anchor="m81df2c7339d87eb1e4618459438e192fddce6019">
      <author>Nadav Kohen</author>
      <timestamp>2020-08-20T15:28:00.000Z</timestamp>
    </message>
    <message id="msg_4" depth="3" position="3" reply_to="Nadav Kohen" parent_id="mailing-list-2020-08-m81df2c7339d87eb1e4618459438e192fddce6019" anchor="m68e1ab3309f73b9562fb53eec3a2667112a89116">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-20T21:38:00.000Z</timestamp>
    </message>
    <message id="msg_5" depth="2" position="4" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-08-m9a793122ab782594fe1af16be43036377eebfad8" anchor="m0899ceeec014253941af9da9e84836f26bcdb499">
      <author>Chris Belcher</author>
      <timestamp>2020-08-20T22:15:00.000Z</timestamp>
    </message>
    <message id="msg_6" depth="4" position="5" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-08-m68e1ab3309f73b9562fb53eec3a2667112a89116" anchor="m5b95a0a3f19a88ff656cf7094069deedeb2111bb">
      <author>Chris Belcher</author>
      <timestamp>2020-08-20T22:37:00.000Z</timestamp>
    </message>
    <message id="msg_7" depth="3" position="6" reply_to="Chris Belcher" parent_id="mailing-list-2020-08-m0899ceeec014253941af9da9e84836f26bcdb499" anchor="m7e3c0325d8889bcbf562c1c9a46c5ae641ee7d85">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-21T04:20:00.000Z</timestamp>
    </message>
    <message id="msg_8" depth="4" position="7" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-08-m7e3c0325d8889bcbf562c1c9a46c5ae641ee7d85" anchor="mb4cde802e2ef564c4cf0236c4c7e8698b458e4d9">
      <author>Chris Belcher</author>
      <timestamp>2020-08-21T09:47:00.000Z</timestamp>
    </message>
    <message id="msg_9" depth="5" position="8" reply_to="Chris Belcher" parent_id="mailing-list-2020-08-mb4cde802e2ef564c4cf0236c4c7e8698b458e4d9" anchor="mf5d158bb6922acce66db15e255422409a9f973cd">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-22T01:09:00.000Z</timestamp>
    </message>
    <message id="msg_10" depth="1" position="9" reply_to="[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap Chris Belcher" parent_id="mailing-list-2020-08-me25a5125e7b4da1b5f807e8affb712e2be9a592c" anchor="meb781bdc051e2b16d4aeb41acec1a5642015169e">
      <author>Antoine Riard</author>
      <timestamp>2020-08-24T19:30:00.000Z</timestamp>
    </message>
    <message id="msg_11" depth="2" position="10" reply_to="Antoine Riard" parent_id="mailing-list-2020-08-meb781bdc051e2b16d4aeb41acec1a5642015169e" anchor="mc87544eb570c6770149b8c34cca95a66e4d085c9">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-25T03:16:00.000Z</timestamp>
    </message>
    <message id="msg_12" depth="2" position="11" reply_to="Antoine Riard" parent_id="mailing-list-2020-08-meb781bdc051e2b16d4aeb41acec1a5642015169e" anchor="m7407914e8581166aa88f5580b281873086c0e17b">
      <author>Chris Belcher</author>
      <timestamp>2020-08-29T22:03:00.000Z</timestamp>
    </message>
    <message id="msg_13" depth="3" position="12" reply_to="Chris Belcher" parent_id="mailing-list-2020-08-m7407914e8581166aa88f5580b281873086c0e17b" anchor="m2050b0ff669a8cc5d7f4fbe8cb8671685b46a828">
      <author>ZmnSCPxj</author>
      <timestamp>2020-08-30T13:38:00.000Z</timestamp>
    </message>
    <message id="msg_14" depth="3" position="13" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-09-mc87544eb570c6770149b8c34cca95a66e4d085c9" anchor="m30d192502e3a720d313f5dc07542381c5dd1a1a0">
      <author>Chris Belcher</author>
      <timestamp>2020-09-03T09:00:00.000Z</timestamp>
    </message>
    <message id="msg_15" depth="4" position="14" reply_to="Chris Belcher" parent_id="mailing-list-2020-09-m30d192502e3a720d313f5dc07542381c5dd1a1a0" anchor="m657375d506a8b90e85271b29cbc5a6e24b1b9766">
      <author>ZmnSCPxj</author>
      <timestamp>2020-09-03T09:45:00.000Z</timestamp>
    </message>
    <message id="msg_16" depth="5" position="15" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-09-m657375d506a8b90e85271b29cbc5a6e24b1b9766" anchor="mfc795178497ac6dead275abcfdcd38db8e61f37d">
      <author>Chris Belcher</author>
      <timestamp>2020-09-03T10:50:00.000Z</timestamp>
    </message>
    <message id="msg_17" depth="6" position="16" reply_to="Chris Belcher" parent_id="mailing-list-2020-09-mfc795178497ac6dead275abcfdcd38db8e61f37d" anchor="m1d16edada22fa5831ae253c921fe8b0091826eea">
      <author>ZmnSCPxj</author>
      <timestamp>2020-09-03T23:39:00.000Z</timestamp>
    </message>
    <message id="msg_18" depth="3" position="17" reply_to="Chris Belcher" parent_id="mailing-list-2020-09-m7407914e8581166aa88f5580b281873086c0e17b" anchor="m8c0c4b44d2e88218d9e6fecb0322d49bdea4620b">
      <author>Antoine Riard</author>
      <timestamp>2020-09-05T01:07:00.000Z</timestamp>
    </message>
    <message id="msg_19" depth="3" position="18" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-09-mc87544eb570c6770149b8c34cca95a66e4d085c9" anchor="mb95d482fe3ec86a45c840ab4e897de67da1072e7">
      <author>Antoine Riard</author>
      <timestamp>2020-09-05T01:10:00.000Z</timestamp>
    </message>
    <message id="msg_20" depth="4" position="19" reply_to="Antoine Riard" parent_id="mailing-list-2020-09-mb95d482fe3ec86a45c840ab4e897de67da1072e7" anchor="m2ae2a90a14ea79508fb366d436007f1706d25cdc">
      <author>ZmnSCPxj</author>
      <timestamp>2020-09-05T02:29:00.000Z</timestamp>
    </message>
    <message id="msg_21" depth="7" position="20" reply_to="ZmnSCPxj" parent_id="mailing-list-2020-09-m1d16edada22fa5831ae253c921fe8b0091826eea" anchor="m2ad82a14e1250c785058bc6427e86c4bb030f6fc">
      <author>ZmnSCPxj</author>
      <timestamp>2020-09-05T02:45:00.000Z</timestamp>
    </message>
    <message id="msg_22" depth="4" position="21" reply_to="Antoine Riard" parent_id="mailing-list-2020-09-m8c0c4b44d2e88218d9e6fecb0322d49bdea4620b" anchor="m7368a068dd5a297978ad88125bbc1f5973538eca">
      <author>seid Mohammed</author>
      <timestamp>2020-09-06T03:06:00.000Z</timestamp>
    </message>
    <message id="msg_23" depth="1" position="22" reply_to="[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap Chris Belcher" parent_id="mailing-list-2020-10-me25a5125e7b4da1b5f807e8affb712e2be9a592c" anchor="me5fd4fa118fe173483fcb50624081feba11199fd">
      <author>[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap appendium Chris Belcher</author>
      <timestamp>2020-10-03T10:36:00.000Z</timestamp>
    </message>
    <message id="msg_24" depth="2" position="23" reply_to="[bitcoin-dev] Detailed protocol design for routed multi-transaction CoinSwap appendium Chris Belcher" parent_id="mailing-list-2020-10-me5fd4fa118fe173483fcb50624081feba11199fd" anchor="m94a871ceb19db6a1f07419fa1358d9fff924e571">
      <author>ZmnSCPxj</author>
      <timestamp>2020-10-03T13:31:00.000Z</timestamp>
    </message>
  </thread>
  <link href="bitcoin-dev/Sept_2020/018163_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018160_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018158_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018162_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018161_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018157_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018153_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018152_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Sept_2020/018151_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018147_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018146_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018141_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018135_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018128_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018117_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018113_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018111_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018110_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018109_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018108_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018106_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="bitcoin-dev/Aug_2020/018080_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.xml" rel="alternate"/>
  <link href="https://gnusha.org/url/https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-August/018080.html" rel="alternate"/>
  <entry>
    <id>2</id>
    <title>Combined summary - Detailed protocol design for routed multi-transaction CoinSwap</title>
    <updated>2025-09-26T15:32:35.635760+00:00</updated>
    <link href="https://gnusha.org/url/https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-August/018080.html" rel="alternate"/>
    <published>2020-09-06T03:06:52+00:00</published>
    <summary>to create multisig addresses, and funds were locked into these addresses. Contract transactions were created to transfer funds using timelocks or hash preimage values. Various vulnerabilities in the protocol were identified, such as fee model vulnerability and transaction pinning vulnerability. Proposed solutions included using anchor outputs in contract transactions and separating timelock and hashlock cases into separate transactions. The implementation of CoinSwap involved broadcasting and mining contract transactions, waiting for timeouts, and using hash preimage values to retrieve funds. Parties paid their own miner fees in timeout failure cases, and anti-DOS features were implemented to prevent attacks.The email exchanges also discussed the usage of relative and absolute locktimes in contract transactions with Scriptless Script, specifically Pointlock transactions. Absolute locktimes allowed participants to define their fee ranges without negotiation. Private key turnover was suggested to reduce funding lockup time for multi-hop swaps, and diagrams were provided to illustrate different scenarios.The CoinSwap protocol aimed to improve privacy by allowing users to swap Bitcoin without revealing amounts or addresses. Multiple transactions were used in a single CoinSwap to avoid amount correlation. Makers only knew their previous and next transactions, while the taker knew the entire route. Funding transactions paid into 2-of-2 multisig addresses, and contract transactions transferred coins to a contract that could be spent with timelocks or hash preimage values. Vulnerabilities such as pinning scenarios and theft attempts were addressed through various solutions, including watchtowers to guard CoinSwaps and prevent theft attempts.The implementation of CoinSwap for privacy and fungibility was being worked on by Chris Belcher. The protocol included multi-transaction CoinSwaps, routed CoinSwaps, liquidity markets, private key handover, and fidelity bonds. Contract transactions played a crucial role, and vulnerabilities and proposed solutions were discussed. Absolute timelocks, watchtowers, and split UTXOs were proposed to enhance the protocol. Relative timelocks, DOS-resistance, and deviations from the protocol were also addressed.In an email exchange between Nadav and ZmnSCPxj, concerns about the security of a proposed public key scheme for Bitcoin transactions were discussed. The main concern was the potential for the taker to steal funds by manipulating the nonce point used in the transaction. ZmnSCPxj clarified that the taker must provide the actual value of the nonce to the maker, eliminating the need for the maker to trust the taker's calculations. The discussion then shifted towards the use of 2p-ECDSA for privacy protection in CoinSwap transactions. While ZmnSCPxj argued that using OP_CHECKMULTISIG instead of 2p-ECDSA would remove most of the privacy advantages, he acknowledged the possibility of implementing OP_CHECKMULTISIG first and adding 2p-ECDSA later. Nadav agreed but emphasized the significant privacy benefits of singlesig anonymity sets.The implementation of CoinSwap involved two parties, the taker and maker, exchanging coins through atomic cross-chain trading. The protocol started with the taker broadcasting a funding transaction to a 2-of-2 multisig address and creating HTLCs specifying amounts and addresses. The maker signed the HTLCs, creating contract transactions that were not broadcast but exchanged between the parties. The EC tweak trick could be used to reduce round trips required for agreeing on public keys. Concerns were raised about a possible attack by a malicious taker who intentionally aborts the swap, causing makers to lose more money than the attacker. Parties needed to be prepared to respond to contract transactions at all times, as the outputs of the funding transactions could remain unspent indefinitely.ZmnSCPxj raised concerns about the security of CoinSwap, particularly regarding the taker providing the nonce 'p' to the maker, which could potentially lead to fund theft. He suggested using 2p-ECDSA to address this issue. Additionally, he emphasized the importance of hiding among larger singlesig anonymity sets and discussed the use of HTLCs in open-coded SCRIPTs for increased privacy.Nadav raised concerns about the proposed CoinSwap protocol on the bitcoin-dev mailing list, particularly regarding the generation of signatures for HTLCs from the pubkey used in Bitcoin transactions. He suggested the use of Zero Knowledge Proof of Knowledge (ZKPoK) or a different key implementation like MuSig. The email also explored the advantages of direct connections to Alice over CoinJoin and potential leaks in CoinSwap. Makers having no incentive to pay fees and takers setting limits on maker's transactions were mentioned. Contract transactions that spend from the 2-of-2 multisig outputs were explained, with staggered timelocks to allow for recovery in case of malicious actions. The EC tweak trick was highlighted as a way to reduce one round trip when agreeing on public keys.The email thread provided insights into the proposed CoinSwap protocol and its potential deviations. It highlighted the use of multi-transaction CoinSwaps, routed CoinSwaps,</summary>
  </entry>
</feed>