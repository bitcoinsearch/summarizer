<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
  <updated>2025-11-12T03:48:52.822022+00:00</updated>
  <author>
    <name>Johnson Lau 2018-12-14 13:55:00+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
    <updated>2025-11-12T03:48:52.822053+00:00</updated>
    <link href="https://gnusha.org/pi/bitcoindev/20181128140412.GC22873@mcelrath.org/T/#m1f74a84b4e165eb8d25d01d0d564fb01fe0b83fd" rel="alternate"/>
    <summary>In the discussion about the new sighash proposal for Bitcoin scripting, a significant modification is outlined to address an issue with the OP_CODESEPARATOR operation in the context of NOINPUT. The proposed change involves signing the hash of the entire script or a masked version of it without truncating any part. This approach contrasts with the current mechanism and aims to preserve the functionality of OP_CODESEPARATOR under the new conditions.

The problem identified with using OP_CODESEPARATOR alongside NOINPUT arises from the fact that, without committing to the masked script, NOINPUT would essentially be committing to an arbitrary position of OP_CODESEPARATOR. This randomness introduces insecurity because a wallet cannot determine which codes are being executed, rendering OP_CODESEPARATOR either unusable or insecure within this framework.

To mitigate these issues and ensure that OP_CODESEPARATOR can function as intended, the solution includes committing to the position of the last executed OP_CODESEPARATOR within the script. This commitment allows the system to maintain integrity and security by making the execution context of OP_CODESEPARATOR explicit and verifiable, hence resolving the potential vulnerabilities introduced by the NOINPUT feature without compromising on the functionality and flexibility that OP_CODESEPARATOR offers in script execution.</summary>
    <published>2018-12-14T13:55:00+00:00</published>
  </entry>
</feed>
