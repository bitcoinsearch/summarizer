<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
  <updated>2025-11-12T03:47:47.947647+00:00</updated>
  <author>
    <name>Rusty Russell 2018-12-13 00:37:00+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
    <updated>2025-11-12T03:47:47.947677+00:00</updated>
    <link href="https://gnusha.org/pi/bitcoindev/20181128140412.GC22873@mcelrath.org/T/#m932953b789ae8eab6f51d6657b1dbe1a7691bdb7" rel="alternate"/>
    <summary>In a technical discussion between Anthony Towns and Rusty Russell, an in-depth analysis of the implications of using NOINPUT in transaction signing within Bitcoin's architecture was provided. Rusty revisited the foundational paper and corrected his previous stance, noting that the constant for the timelock comparison alters with each update, making the case against introducing a new opcode like OP_TIMELOCKGREATERVERIFY due to the complexity it would entail in remembering the nLocktime for the UTXO.

The discourse then shifts towards evaluating the necessity and potential complications of incorporating the NOINPUT flag alongside the option of not implementing the mask feature, essentially questioning its utility and safety. The NOINPUT flag, as highlighted, poses a significant risk except in scenarios where re-signing a transaction is not feasible, necessitating the creation of a new transaction even if a particular input has been spent. This condition underscores the vulnerability to attacks unless other inputs are also signed with NOINPUT or with SIGHASH_SINGLE|ANYONECANPAY, indicating a complex landscape of dependency on both key-reuse and amount-reuse for security breaches.

Furthermore, the conversation delves into the specifics of how SIGHASH_MASK operates by limiting the reuse of an input for standard outputs, which could potentially expose users to risks if the same key is employed across multiple scripts of identical nature. This risk is amplified within the context of lightning software, which is likely to utilize a singular script across various transactions, contrasting with the diverse key usage in conventional wallet transactions.

Rusty concludes by asserting the inherent dangers linked with the use of NOINPUT in cases of key reuse, strongly advising against such practices. This exchange not only reflects on the technical intricacies involved in enhancing Bitcoin's transaction protocol but also on the cautious approach needed when considering modifications to its underlying security mechanisms.</summary>
    <published>2018-12-13T00:37:00+00:00</published>
  </entry>
</feed>
