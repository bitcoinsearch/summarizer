<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>1</id>
  <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
  <updated>2025-11-12T03:46:51.382644+00:00</updated>
  <author>
    <name>Johnson Lau 2018-12-12 19:53:00+00:00</name>
  </author>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>1</id>
    <title>Re: Safer sighashes and more granular SIGHASH_NOINPUT</title>
    <updated>2025-11-12T03:46:51.382678+00:00</updated>
    <link href="https://gnusha.org/pi/bitcoindev/20181128140412.GC22873@mcelrath.org/T/#m6feba2ca9ec27c1226cff049ee40586a9997676d" rel="alternate"/>
    <summary>The discussion delves into the issue of witness weight malleability in Bitcoin's scripting language, pinpointing its root cause to certain opcodes that accept variable size inputs, which do not influence the output but are supplied by the puzzle solver. This issue is scrutinized through an examination of specific opcodes such as IF, NOTIF, VERIFY, DROP, 2DROP, NIP, DEPTH, along with all arithmetic opcodes that accept CScriptNum, including CHECKMULTISIG. It is highlighted that VERIFY, DROP, 2DROP, and NIP do not pose a substantial problem since they are not designed to interact directly with data from the puzzle solver at the outset. The discussion further explains how CHECKMULTISIG has been addressed by BIP147, ensuring that both the key number and sig number, being integral components of the script, are not susceptible to malleability.

Furthermore, the dialogue touches upon the DEPTH opcode, noting that it only becomes problematic if its inputs are not subsequently verified by other opcodes, rendering the concern somewhat moot. It mentions a policy known as MINIMAL_IF, which mandates that the input for OP_IF be minimal, effectively mitigating potential issues. This conversation also suggests that taproot could serve as a replacement for OP_IF in many instances, further enhancing script integrity. Additionally, the non-minimal CScriptNum issue is tackled by BIP62 policy, which bans such practices outright.

The communication underscores the necessity for miners to enforce these policies strictly to prevent malicious third-party witness bloating. This is crucial because accepting transactions with malleated sizes would diminish the available block space, which is counterproductive for miners. If miners disapprove of a transaction, the straightforward action would be to exclude it altogether rather than compromising the block's capacity. This approach ensures that the blockchain remains efficient and free from unnecessary bloat.</summary>
    <published>2018-12-12T19:53:00+00:00</published>
  </entry>
</feed>
