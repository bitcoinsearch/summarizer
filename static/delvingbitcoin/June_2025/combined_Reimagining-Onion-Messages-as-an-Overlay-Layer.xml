<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - Reimagining Onion Messages as an Overlay Layer</title>
  <updated>2025-07-01T03:56:20.282029+00:00</updated>
  <author>
    <name>roasbeef 2025-06-30 19:23:57.410000+00:00</name>
  </author>
  <author>
    <name>MattCorallo 2025-06-30 12:41:34.142000+00:00</name>
  </author>
  <author>
    <name>shocknet_justin 2025-06-28 18:12:18.711000+00:00</name>
  </author>
  <author>
    <name>roasbeef 2025-06-28 01:56:34.150000+00:00</name>
  </author>
  <link href="delvingbitcoin/June_2025/5380_Reimagining-Onion-Messages-as-an-Overlay-Layer.xml" rel="alternate"/>
  <link href="delvingbitcoin/June_2025/5374_Reimagining-Onion-Messages-as-an-Overlay-Layer.xml" rel="alternate"/>
  <link href="delvingbitcoin/June_2025/5367_Reimagining-Onion-Messages-as-an-Overlay-Layer.xml" rel="alternate"/>
  <link href="delvingbitcoin/June_2025/5361_Reimagining-Onion-Messages-as-an-Overlay-Layer.xml" rel="alternate"/>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <entry>
    <id>2</id>
    <title>Combined summary - Reimagining Onion Messages as an Overlay Layer</title>
    <updated>2025-07-01T03:56:20.282080+00:00</updated>
    <link href="https://delvingbitcoin.org/t/reimagining-onion-messages-as-an-overlay-layer/1799" rel="alternate"/>
    <summary>The concept of onion messaging within the Lightning Network is currently undergoing scrutiny and proposed evolution. The existing method embeds onion messages directly into the channel graph, linking them tightly with the channel links. This approach has been criticized for being slow, fragile, and inefficient, leading to increased latency in message delivery and payment attempts due to its all-or-nothing adoption strategy and the large diameter of the onion messaging graph. Additionally, this tight integration does not address quality of service concerns effectively, with head-of-line blocking in TCP connections further exacerbating the issue. 

A new proposal suggests developing an onion messaging overlay layer that operates independently of the channel graph. By leveraging the LN gossip network and long-term node identity keys, this overlay would allow for more flexible and rapid deployment, experimentation, and a potentially smaller graph diameter for quicker message delivery. The connection establishment process for this overlay involves a series of messages that culminate in a verifiable Musig2 signature, ensuring the authenticity of the onion messaging link. This process implies that only a fraction of the current nodes need to participate for the overlay to function effectively.

Furthermore, the overlay network could coexist with the current embedded onion messaging system, allowing nodes to maintain connections to both networks simultaneously without disrupting existing applications. This dual-system approach promises to enhance the user experience by reducing latency and enabling faster, more reliable message delivery across the network. The overlay also opens up possibilities for innovations such as payment acknowledgments and retryable payments, which could further refine and improve the efficiency of the network.

The technical details of establishing and maintaining these onion messaging links involve specific message types and TLV fields designed to facilitate secure and verifiable connections between nodes. These include `onion_link_req`, `onion_link_resp`, `onion_link_sign`, and `onion_link_proof` messages, each serving a unique purpose in the link establishment process. Additionally, the proposal introduces modifications to the `node_announcement` message to support the discovery of onion links within the overlay network.

Criticism of the current onion messaging system highlights its limitations and inefficiencies, particularly regarding DoS protection and the handling of peer selection and message forwarding. The reliance on existing channel partners for message forwarding introduces inherent anti-DoS measures but fails to provide a comprehensive solution to service quality and reliability issues. The proposed overlay network aims to address these shortcomings by decoupling onion messaging from direct channel links, thus enabling more agile development and deployment strategies.

In conclusion, reimagining onion messaging as an overlay layer offers numerous benefits, including improved reliability, reduced latency, and enhanced overall user experience. By adopting this alternative deployment strategy, the Lightning Network could see significant advancements in its messaging capabilities, facilitating better communication and transaction efficiency across the network.</summary>
    <published>2025-06-30T19:23:57.410000+00:00</published>
  </entry>
</feed>
