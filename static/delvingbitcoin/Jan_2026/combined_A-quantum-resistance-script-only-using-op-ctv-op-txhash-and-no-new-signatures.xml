<?xml version="1.0" ?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - A quantum resistance script only using op_ctv/op_txhash and no new signatures</title>
  <updated>2026-01-09T03:01:58.267036+00:00</updated>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <thread>
    <message id="msg_1" depth="0" position="0">
      <author>simul</author>
      <timestamp>2025-12-18 23:27:11.773000+00:00</timestamp>
    </message>
    <message id="msg_2" depth="0" position="1">
      <author>reardencode</author>
      <timestamp>2025-12-30 19:14:33.031000+00:00</timestamp>
    </message>
    <message id="msg_3" depth="0" position="2">
      <author>simul</author>
      <timestamp>2026-01-08 12:16:09.922000+00:00</timestamp>
    </message>
  </thread>
  <link href="delvingbitcoin/Dec_2025/6461_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <link href="delvingbitcoin/Dec_2025/6492_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <link href="delvingbitcoin/Jan_2026/6585_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <entry>
    <id>2</id>
    <title>Combined summary - A quantum resistance script only using op_ctv/op_txhash and no new signatures</title>
    <updated>2026-01-09T03:01:58.267683+00:00</updated>
    <link href="https://delvingbitcoin.org/t/a-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures/2168/3" rel="alternate"/>
    <published>2025-12-18 23:27:11.773000+00:00</published>
    <summary>The email delves into an advanced strategy designed to fortify Bitcoin transactions against the threats posed by quantum computing and attempts at signature forgery. This approach integrates OP_CHECKTEMPLATEVERIFY (OP_CTV) alongside the OP_TXHASH/OP_CHECKTXHASHVERIFY protocols, as delineated in BIP119 and a nascent draft proposal. The core of this methodology is the establishment of a multi-phase envelope mechanism. This system is ingeniously crafted to safeguard funds by restricting their movement to within a secure Anchor envelope from which they can only be transferred along pre-specified pathways. This protective measure effectively guards against quantum computing threats by disabling Taproot key-path spending and leveraging Nothing-Up-My-Sleeve (NUMS) internal keys. These keys compel all Taproot outputs to navigate through the script path, thereby enhancing their security.
The process is initiated with Phase 0, aiming to channel all value into a predetermined Anchor envelope without locking down final recipients or future templates. This phase employs OP_TXHASH to enforce conditions that curtail any potential leakage of value outside of the Anchor output while also limiting the extraction of transaction fees. Following this, Phase 1 involves the expenditure of the Phase 0 UTXO to generate the Anchor UTXO, thereby materializing the Anchor envelope on the blockchain without providing attackers any opportunity to misdirect the value. The Anchor UTXO is structured around a Taproot script tree that offers two distinct spending routes: a reveal path and an escape hatch, each with its specific conditions enforced by OP_CTV.
In Phase 2, a choice between these paths is made to expend the Anchor UTXO, incorporating security measures to ensure the protection of value even in the event of compromised signatures. This layered approach prevents attackers from doing anything beyond delaying or enforcing transaction execution, rather than enabling them to steal funds. Such a configuration not only offers resistance to quantum attacks but also to reorganization, courtesy of the relative timelock mechanism. Moreover, the protocol is designed to gracefully degrade in response to advancements in quantum technology and does not necessitate nodes to maintain historical transaction indices, making it favorable for pruning.
Addressing several challenges, the discussion highlights the necessity for both transaction and expenditure amounts to be predefined in Phase 0 outputs to match the total CTV output values, complicating the consolidation process due to limited flexibility and foresight. Furthermore, the current reliance on secp256k1 and NUMS points introduces a quantum vulnerability, exposing the construction to potential compromise by quantum adversaries. This poses a significant security risk, as the construction in its present form is not deemed quantum safe. Additionally, there's a noted inability for users to redirect funds to a new, quantum-secure address upon withdrawal, indicating a lack of adaptability to upcoming security requirements.
A proposed solution to these highlighted issues is the adoption of Conditioned Commitment Verification (CCV) instead of relying solely on TXHASH for transactions. Implementing CCV could effectively mitigate initial concerns by enforcing value flow and integrating and extracting the CTV reveal spend at the point of spending rather than creation. Moreover, CCV allows for an escape spend with value flexibility, thus enhancing both the security and usability of the construction. By incorporating CCV, the structure could emulate a standard vault construct while uniquely embedding a hash and preimage for the reveal-spend, potentially addressing the concerns raised.
For further information and demonstration code, readers are directed to a [Gist](https://gist.github.com/earonesty/ea086aa995be1a860af093f93bd45bf2). Lastly, it's clarified that contrary to some misconceptions, the proposal does not rely on NUMS points for the escape hatch, which reverts to the original framework, ensuring that an attacker cannot spend but only cause grief.</summary>
  </entry>
</feed>