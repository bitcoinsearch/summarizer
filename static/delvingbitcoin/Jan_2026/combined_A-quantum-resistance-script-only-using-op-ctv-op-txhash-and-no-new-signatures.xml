<?xml version="1.0" ?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>2</id>
  <title>Combined summary - A quantum resistance script only using op_ctv/op_txhash and no new signatures</title>
  <updated>2026-01-10T02:57:10.844458+00:00</updated>
  <generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator>
  <thread>
    <message id="msg_1" depth="0" position="0">
      <author>simul</author>
      <timestamp>2025-12-18 23:27:11.773000+00:00</timestamp>
    </message>
    <message id="msg_2" depth="0" position="1">
      <author>reardencode</author>
      <timestamp>2025-12-30 19:14:33.031000+00:00</timestamp>
    </message>
    <message id="msg_3" depth="0" position="2">
      <author>simul</author>
      <timestamp>2026-01-08 12:16:09.922000+00:00</timestamp>
    </message>
    <message id="msg_4" depth="0" position="3">
      <author>reardencode</author>
      <timestamp>2026-01-09 04:06:31.647000+00:00</timestamp>
    </message>
  </thread>
  <link href="delvingbitcoin/Dec_2025/6461_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <link href="delvingbitcoin/Dec_2025/6492_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <link href="delvingbitcoin/Jan_2026/6585_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <link href="delvingbitcoin/Jan_2026/6591_A-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures.xml" rel="alternate"/>
  <entry>
    <id>2</id>
    <title>Combined summary - A quantum resistance script only using op_ctv/op_txhash and no new signatures</title>
    <updated>2026-01-10T02:57:10.845090+00:00</updated>
    <link href="https://delvingbitcoin.org/t/a-quantum-resistance-script-only-using-op-ctv-op-txhash-and-no-new-signatures/2168/4" rel="alternate"/>
    <published>2025-12-18 23:27:11.773000+00:00</published>
    <summary>The discussion presents an advanced method to protect Bitcoin transactions from quantum attacks and the risk of signature forgery. This is achieved by leveraging the combination of OP_CHECKTEMPLATEVERIFY (OP_CTV) and proposed OP_TXHASH/OP_CHECKTXHASHVERIFY protocols, as outlined in Bitcoin Improvement Proposal 119 (BIP119) and a current draft proposal. The approach introduces a multi-phase envelope strategy that safeguards funds by restricting their movement to predefined paths, thereby ensuring security even in the event of compromised signatures. This system specifically targets enhancing security against quantum threats by disabling Taproot key-path spending through the use of Nothing-Up-My-Sleeve (NUMS) internal keys, which compels all Taproot outputs to proceed via the script path.
In the initial phase of this model, referred to as Phase 0, the primary goal is to channel all value into a predetermined Anchor envelope without finalizing recipients or future templates. This is accomplished using OP_TXHASH to enforce conditions that prevent the leaking of value outside of the Anchor output and limit the extraction of transaction fees. Following this, Phase 1 involves spending the Phase 0 UTXO to create the Anchor UTXO, effectively bringing it onto the blockchain while preventing attackers from diverting the value. The Anchor UTXO employs a Taproot script tree that provides two spending paths: a reveal path and an escape hatch, both of which are secured by OP_CTV. Phase 2 then allows for the choice between these paths to spend the Anchor UTXO, with measures in place to ensure the security of value even if signatures are compromised.
This structured approach notably restricts potential attackers to merely delaying or forcing the execution of transactions rather than enabling them to steal funds. It achieves reorg resistance through the use of a relative timelock mechanism and does not necessitate nodes to maintain historical transaction indices, thus being friendly to pruning practices. For those seeking technical details and demonstration code, the original discussion includes a link to a [Gist](https://gist.github.com/earonesty/ea086aa995be1a860af093f93bd45bf2).
However, challenges with this construction arise, particularly regarding the necessity for both transaction (T) and expenditure (E) amounts to be predetermined at the creation of Phase 0 outputs. This requirement for precise consolidation to match the total CTV output values limits transactional flexibility and foresight. Moreover, the reliance on secp256k1 and NUMS points introduces a vulnerability to quantum attacks, as these could potentially be compromised by quantum adversaries. This current reliance deems the construction not quantum safe, lacking adaptability to emerging security needs and restricting users' ability to protect their assets against technological advancements. A suggested remedy to these issues is the adoption of Conditioned Commitment Verification (CCV), which could offer value flow enforcement, integration, and extraction of the CTV reveal spend at the time of spending, thus providing an enhanced security framework and overcoming the identified limitations.
An additional aspect of the proposal considers an operation mechanism independent of NUMS points, aiming to mitigate potential damage through a fallback to the system's original construction. This design decision emphasizes a foundational structure as a safeguard against malicious activities, limiting an attacker's impact to causing disruption rather than expending resources from the system. The discussion also queries the operational intent regarding P2TR or P2TSH contexts for TXHASH or CTV locks, highlighting the implications for security against quantum adversaries depending on the chosen context.</summary>
  </entry>
</feed>